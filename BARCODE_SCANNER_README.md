# Сканер штрихкодов - Инструкция по использованию

## Обзор

В приложение добавлена функциональность сканирования штрихкодов для поля `barcode` в форме создания и редактирования продуктов. Сканер использует камеру устройства для считывания различных типов штрихкодов.

## Установленные зависимости

```bash
npm install @zxing/library
```

Библиотека `@zxing/library` поддерживает следующие типы штрихкодов:
- EAN-13
- EAN-8
- UPC-A
- UPC-E
- Code 128
- Code 39
- QR Code
- Data Matrix
- И многие другие

## Как использовать

### 1. Создание продукта с штрихкодом

1. Откройте форму создания нового продукта
2. Выберите категорию, которая содержит атрибут `barcode`
3. В поле "Штрихкод" вы увидите:
   - Текстовое поле для ручного ввода
   - Кнопку "Scan" с иконкой сканера

### 2. Сканирование штрихкода

1. Нажмите кнопку "Scan" рядом с полем штрихкода
2. Откроется модальное окно со сканером
3. Разрешите доступ к камере, если браузер запросит
4. Наведите камеру на штрихкод
5. Штрихкод автоматически считывается и заполняется в поле

### 3. Ручной ввод

Если сканирование не работает или вы хотите ввести штрихкод вручную:
1. Введите штрихкод в текстовое поле
2. Или используйте поле "Or enter barcode manually" в модальном окне сканера

## Особенности реализации

### Компонент BarcodeScanner

Файл: `src/components/BarcodeScanner.jsx`

- Использует библиотеку `@zxing/library` для считывания штрихкодов
- Поддерживает автоматическое сканирование через камеру
- Имеет fallback для ручного ввода
- Показывает инструкции пользователю
- Обрабатывает ошибки (отсутствие камеры, проблемы с правами доступа)

### Интеграция с формами

Компоненты `ProductFormNew.jsx` и `EditProductNew.jsx` были обновлены:

- Автоматическое определение поля `barcode` по имени атрибута
- Специальный UI с кнопкой сканирования
- Интеграция с системой валидации
- Поддержка как создания, так и редактирования продуктов

## Поддерживаемые устройства

### Мобильные устройства
- ✅ Смартфоны (Android, iOS)
- ✅ Планшеты
- ✅ Мобильные браузеры

### Десктопные устройства
- ✅ Ноутбуки с веб-камерой
- ✅ ПК с USB-камерой
- ✅ Внешние веб-камеры

## Требования к браузеру

- Поддержка WebRTC (для доступа к камере)
- HTTPS соединение (для доступа к камере в продакшене)
- Современный браузер (Chrome, Firefox, Safari, Edge)

## Устранение неполадок

### Камера не работает
1. Проверьте, что браузер имеет доступ к камере
2. Убедитесь, что камера не используется другими приложениями
3. Попробуйте обновить страницу

### Штрихкод не считывается
1. Убедитесь, что штрихкод хорошо освещен
2. Держите камеру на расстоянии 10-30 см от штрихкода
3. Убедитесь, что штрихкод не поврежден
4. Попробуйте ручной ввод

### Ошибка "No camera found"
1. Подключите камеру к устройству
2. Проверьте права доступа браузера к камере
3. Попробуйте другой браузер

## Безопасность

- Доступ к камере запрашивается только при открытии сканера
- Камера автоматически отключается при закрытии сканера
- Данные штрихкода не сохраняются локально
- Все операции выполняются в браузере

## Расширение функциональности

Для добавления поддержки других типов штрихкодов или изменения поведения сканера, отредактируйте файл `src/components/BarcodeScanner.jsx`.

## Тестирование

Для тестирования сканера можно использовать:
- Онлайн генераторы штрихкодов
- Физические товары с штрихкодами
- QR-коды с текстовой информацией

## Примечания для разработчиков

### Структура кода
```
src/
├── components/
│   ├── BarcodeScanner.jsx          # Основной компонент сканера
│   ├── ProductFormNew.jsx          # Форма создания продукта
│   └── EditProductNew.jsx          # Форма редактирования продукта
```

### Ключевые функции
- `handleBarcodeScan()` - обработка отсканированного кода
- `startScanning()` - запуск сканирования
- `stopScanning()` - остановка сканирования
- `handleManualInput()` - ручной ввод

### Интеграция с бэкендом
Сканер работает только на фронтенде. Для полной интеграции убедитесь, что:
1. В базе данных есть атрибут с именем `barcode`
2. Бэкенд корректно обрабатывает значения штрихкодов
3. Валидация на бэкенде поддерживает формат штрихкодов 